<!doctype html>
<html>
<head>
<title>Deadbeat Escapement Simulator</title>
</head>
<body>
<h1>Deadbeat Escapement Simulator</h1>

<canvas id="canvas" width="400" height="600"></canvas>

<script src="planck.min.js"></script>
<script src="renderer.js"></script>
<script src="escapewheel.js"></script>

<script type="text/javascript">
    const { World, Vec2, Box, Circle, Polygon, DistanceJoint } = planck;
    const world = new World({
        gravity: Vec2(0.0, -9.81),
    });

    const renderer = new Renderer(world, 'canvas');

    let pivot = world.createBody({
        type: 'static',
        position: Vec2(0.0, 0.5),
    });

    let bob = world.createBody({
        type: 'dynamic',
        position: Vec2(0.5, -0.5),
    });
    bob.createFixture({
        shape: new Circle(0.25, Vec2(0, 0)),
        density: 1.0,
        friction: 0.3,
    });

    addEscapeWheelFixtures(pivot, {
        teeth: 15,
        minorDiameter: 0.4,
        majorDiameter: 0.6,
        leadingAngle: 5,
        trailingAngle: 8,
    });

    let joint = world.createJoint(new DistanceJoint({}, bob, pivot, bob.getPosition(), pivot.getPosition()));
</script>
</body>
</html>
